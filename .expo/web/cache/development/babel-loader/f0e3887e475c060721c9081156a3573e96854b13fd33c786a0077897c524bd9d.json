{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from \"react\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nvar Transactions = function Transactions() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    transactions = _useState2[0],\n    setTransactions = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    csrfToken = _useState6[0],\n    setCsrfToken = _useState6[1];\n  var _useState7 = useState(''),\n    _useState8 = _slicedToArray(_useState7, 2),\n    accessToken = _useState8[0],\n    setAccessToken = _useState8[1];\n  useEffect(function () {\n    var fetchCsrfToken = function () {\n      var _ref = _asyncToGenerator(function* () {\n        try {\n          var response = yield axios.get('http://127.0.0.1:8000/csrf/');\n          setCsrfToken(response.data.csrfToken);\n        } catch (error) {\n          console.error('Error fetching CSRF token', error);\n        }\n      });\n      return function fetchCsrfToken() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    fetchCsrfToken();\n  }, []);\n  useEffect(function () {\n    var fetchAccessToken = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        try {\n          var token = yield AsyncStorage.getItem('accessToken');\n          setAccessToken(token);\n        } catch (error) {\n          console.error('Error fetching access token', error);\n        }\n      });\n      return function fetchAccessToken() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    fetchAccessToken();\n  }, []);\n  var fetchTransactions = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      try {\n        if (!accessToken || !csrfToken) {\n          console.error('Token or CSRF Token not available');\n          return;\n        }\n        var response = yield axios.get('http://127.0.0.1:8000/transactions/', {\n          headers: {\n            'Authorization': `Bearer ${accessToken}`,\n            'X-CSRFToken': csrfToken\n          }\n        });\n        setTransactions(response.data.transactions);\n        setLoading(false);\n      } catch (error) {\n        console.error(\"Error fetching transactions:\", error);\n        Alert.alert('Error', 'Unable to fetch transactions.');\n        setLoading(false);\n      }\n    });\n    return function fetchTransactions() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    if (accessToken && csrfToken) {\n      fetchTransactions();\n    }\n  }, [accessToken, csrfToken]);\n  var renderItem = function renderItem(_ref4) {\n    var item = _ref4.item;\n    return _jsxs(View, {\n      style: {\n        padding: 10,\n        borderBottomWidth: 1\n      },\n      children: [_jsxs(Text, {\n        children: [\"Sender: \", item.sender]\n      }), _jsxs(Text, {\n        children: [\"Recipient: \", item.recipient]\n      }), _jsxs(Text, {\n        children: [\"Amount: \\u20B1\", item.amount]\n      }), _jsxs(Text, {\n        children: [\"Date: \", item.date]\n      })]\n    });\n  };\n  return _jsx(SafeAreaView, {\n    style: {\n      flex: 1,\n      backgroundColor: '#fff'\n    },\n    children: loading ? _jsx(Text, {\n      children: \"Loading...\"\n    }) : _jsx(FlatList, {\n      data: transactions,\n      keyExtractor: function keyExtractor(item) {\n        return item.id.toString();\n      },\n      renderItem: renderItem\n    })\n  });\n};\nexport default Transactions;","map":{"version":3,"names":["React","useState","useEffect","SafeAreaView","View","Text","FlatList","TouchableOpacity","Alert","axios","AsyncStorage","jsxs","_jsxs","jsx","_jsx","Transactions","_useState","_useState2","_slicedToArray","transactions","setTransactions","_useState3","_useState4","loading","setLoading","_useState5","_useState6","csrfToken","setCsrfToken","_useState7","_useState8","accessToken","setAccessToken","fetchCsrfToken","_ref","_asyncToGenerator","response","get","data","error","console","apply","arguments","fetchAccessToken","_ref2","token","getItem","fetchTransactions","_ref3","headers","alert","renderItem","_ref4","item","style","padding","borderBottomWidth","children","sender","recipient","amount","date","flex","backgroundColor","keyExtractor","id","toString"],"sources":["C:/Users/franc/Desktop/JuanBytes_Frontend/juanbytes/screens/Transactions.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { SafeAreaView, View, Text, FlatList, TouchableOpacity, Alert } from \"react-native\";\r\nimport axios from 'axios';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst Transactions = () => {\r\n    const [transactions, setTransactions] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [csrfToken, setCsrfToken] = useState('');\r\n    const [accessToken, setAccessToken] = useState('');\r\n\r\n    // Fetch CSRF Token\r\n    useEffect(() => {\r\n        const fetchCsrfToken = async () => {\r\n            try {\r\n                const response = await axios.get('http://127.0.0.1:8000/csrf/');\r\n                setCsrfToken(response.data.csrfToken);\r\n            } catch (error) {\r\n                console.error('Error fetching CSRF token', error);\r\n            }\r\n        };\r\n\r\n        fetchCsrfToken();\r\n    }, []); // Empty dependency array to ensure this runs only once\r\n\r\n    // Fetch Access Token\r\n    useEffect(() => {\r\n        const fetchAccessToken = async () => {\r\n            try {\r\n                const token = await AsyncStorage.getItem('accessToken');\r\n                setAccessToken(token);\r\n            } catch (error) {\r\n                console.error('Error fetching access token', error);\r\n            }\r\n        };\r\n\r\n        fetchAccessToken();\r\n    }, []);\r\n\r\n    // Fetch Transactions\r\n    const fetchTransactions = async () => {\r\n        try {\r\n            if (!accessToken || !csrfToken) {\r\n                console.error('Token or CSRF Token not available');\r\n                return;\r\n            }\r\n\r\n            const response = await axios.get('http://127.0.0.1:8000/transactions/', {\r\n                headers: {\r\n                    'Authorization': `Bearer ${accessToken}`,\r\n                    'X-CSRFToken': csrfToken\r\n                }\r\n            });\r\n\r\n            setTransactions(response.data.transactions);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error(\"Error fetching transactions:\", error);\r\n            Alert.alert('Error', 'Unable to fetch transactions.');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (accessToken && csrfToken) {\r\n            fetchTransactions();\r\n        }\r\n    }, [accessToken, csrfToken]);\r\n\r\n    const renderItem = ({ item }) => (\r\n        <View style={{ padding: 10, borderBottomWidth: 1 }}>\r\n            <Text>Sender: {item.sender}</Text>\r\n            <Text>Recipient: {item.recipient}</Text>\r\n            <Text>Amount: â‚±{item.amount}</Text>\r\n            <Text>Date: {item.date}</Text>\r\n        </View>\r\n    );\r\n\r\n    return (\r\n        <SafeAreaView style={{ flex: 1, backgroundColor: '#fff' }}>\r\n            {loading ? (\r\n                <Text>Loading...</Text>\r\n            ) : (\r\n                <FlatList\r\n                    data={transactions}\r\n                    keyExtractor={item => item.id.toString()}\r\n                    renderItem={renderItem}\r\n                />\r\n            )}\r\n        </SafeAreaView>\r\n    );\r\n};\r\n\r\nexport default Transactions;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}